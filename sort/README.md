sort
====

A more universal constexpr sorting function, using keys or comparators!

Features
--------
* Drop in constexpr replacement for `std::sort`.
* Contextually picks radix or counting sorts for keyed sorting.
* Contextually picks partitioning algorithm where sensible.
* Overall: can be upwards of 25% faster than `std::sort`!

Usage
-----

```c
#include <iostream>
#include <vector>
#include <string_view>
#include "sort/sort.h"

/*
NOTE: Comparison functions are in the form
[](const auto& lhs, const auto &rhs) -> bool {...}

while keyed functions are in the form
[](const auto& current) -> integral_type {...}
or
[](const auto& current) -> std::tuple<integral_type,...> {...}

if a keyed function returns a bool, 
[](const auto& current) -> bool {...}
we'll partition the data, where items that return 
true are placed at the back!
*/

int main() {
	std::vector<int> example{42,31,99,3,4,5,96};
	//default ::std::less comparison
	sort::sort(example.begin(),example.end());
	for (const auto &value : example)
		std::cout << value << '\n'

	//NOTE: there's a performance cost to using larger keys!
	//return the smallest integral type that makes sense to use 

	//sort using count_sort implmentation / keyed values
	sort::sort(example.begin(),example.end(),[](const int& value){
		//sort based on swapped nibbles~
		return (value>>4) | (value<<4) & 0xf0;
	});
	for (const auto &value : example)
		std::cout << value << '\n'

	std::vector<std::string_view> strs{
		"hello",
		"world",
		"nice",
		"day",
		"right?"
	};

	//we can order any data based off of any calculation
	sort::sort(strs.begin(),strs.end(),[](const std::string_view& value){
		return value.size();
	});
	for (const auto &value : strs)
		std::cout << value << '\n'

	//or for more complicated structs...off of tuples
	sort::sort(strs.begin(),strs.end(),[](const std::string_view& value){
		return std::make_tuple(value.size()); //this is a bit redundant but that's ok
	});
	for (const auto &value : strs)
		std::cout << value << '\n'
	
	//if we use a keyed type of bool we'll partition data such that positions that
	//return true are placed towards the back 
	//(to be consistant with treating counting_sort's behavior if handed a uint8_t)
	sort::sort(strs.begin(),strs.end(),[](const std::string_view& value){
		return value.size() && value[0]=='n';
	});
	for (const auto &value : strs)
		std::cout << value << '\n'

	return 0;
}
```

Performance
-----------

![sort_performance](https://github.com/Andersama-Library/open-source/assets/25020235/e90bb6f6-1c5c-4df3-bf86-ce44c9c643c7)

```mermaid
xychart-beta
    title "c++ generated chart"
    y-axis "time (in ns)" 0 --> 632620
    x-axis 4 --> 2048
    line "sort::counting_sort_byte_shift_dynamic" [1503,1833,1855,2050,2175,2297,2490,2409,2683,2647,2757,3178,2951,3236,3163,3462,3375,3629,3772,3650,3788,4429,4200,4300,4200,4847,4416,4495,4604,4980,4947,5185,5319,5380,5550,5336,5710,5810,5847,6094,6250,6250,6272,6117,6635,6652,6400,6831,6918,7093,6856,6918,7513,7066,7593,9093,7850,7864,8150,8015,7753,8450,7985,7923,13130,8623,8638,9276,10384,9884,8769,9253,8861,9275,9391,9533,9625,9925,14212,9400,9458,10733,10090,13333,11544,9700,9991,9927,10690,10809,10981,10972,10563,10545,12412,11210,13440,11890,11650,14328,10600,12140,17700,14100,12030,12133,12300,12450,12455,12560,13244,12110,12088,12911,12433,13255,12620,13333,13477,13500,11522,13022,12966,13966,13944,12277,17566,13987,13766,14275,13812,14387,14575,13025,14825,14137,14950,14962,15175,15550,15525,15950,14937,13900,15500,15975,16425,14971,16057,15185,16242,15500,16457,16271,21866,17042,16800,17257,16516,16985,16271,18233,16485,15685,16671,17528,17714,17200,19400,17900,18285,18285,17942,19100,18116,18183,17942,17900,19471,18683,18242,18683,17966,18583,18266,18183,19316,18566,18550,19716,18816,21216,19933,19466,20250,19516,20600,21083,19433,20933,19883,17500,21083,21283,21366,20683,26460,18950,21716,21666,21000,20800,22816,21180,23516,21520,21750,20660,21980,28620,22860,22400,23480,21440,21440,22000,23220,22960,21940,23760,23440,20780,23420,22340,23940,23740,24160,22860,26200,24480,25380,24580,24360,24700,23520,25360,25160,25360,23840,23025,25960,28040,25880,26740,25900,26160,26320,26080,39625,26800,25425,25375,29760,27260,25840,25825,26060,25925,26600,25950,25050,26150,25275,26400,25400,26900,22666,26925,27050,27200,26125,27825,26125,27850,29200,27850,28600,26700,26950,28225,29050,28675,27225,16100,29150,29175,29375,27750,29525,29525,29625,29750,30350,32066,30400,30925,31200,28925,30650,30650,30925,30675,31050,31175,29525,31600,30250,31425,31750,30450,31900,58575,32475,30750,29000,32575,33675,33175,32850,34125,34250,32975,29766,67733,37266,42866,36400,32275,30566,43866,34375,34425,34975,44266,35075,35175,35400,35550,34800,36325,36825,32333,32975,32133,32500,35000,32500,32500,32800,32933,35875,33166,33366,33333,35725,33800,33600,33400,80500,33833,35100,34266,34600,34866,32966,34433,32766,35133,33800,35300,35400,33300,35533,34100,34066,35966,42866,34233,36566,36366,36533,36433,36500,36400,39100,37100,37033,45500,37300,35766,40700,38566,37600,38266,39366,47766,38133,38500,45150,38600,38600,39233,38933,40066,39566,39266,39533,44700,37700,39766,40266,45233,40433,38000,41300,38800,41866,39400,41400,39500,41866,39366,41733,41000,42066,40233,44633,40066,44100,40533,43100,40766,43300,43266,44800,44900,44733,43700,45433,49766,44866,46500,42166,44800,50000,46400,44400,34200,46433,42700,37166,34400,45066,39300,54650,45766,47133,45250,41150,52400,47266,84133,48633,47033,123850,34250,32000,53900,51500,79300,51950,53000,53400,67550,130200,53100,46950,36400,53800,51800,36950,52900,31500,38000,49300,50266,48066,53100,50700,50766,50733,51233,50900,51766,50933,59300,50500,38850,52433,51900,57633,57250]
    line "std::sort" [62,120,205,298,399,513,651,755,1087,1110,1273,1432,1685,1887,2159,2250,3475,2727,2853,2841,3000,3412,3537,3704,3721,4141,4195,4338,4543,5618,5166,5310,5342,5776,6033,5888,6493,6446,6386,6885,7246,7446,7500,8957,7790,8438,8115,8707,8858,9154,9466,9290,9790,9250,9860,9750,10360,10533,10970,11155,11610,11500,11080,12700,24371,11462,12225,13737,12800,12466,15866,12912,12887,13871,14387,14725,14514,14900,20150,14185,14471,16242,15585,18500,19557,17085,15728,17800,16600,16800,17000,17916,16700,16583,21020,18216,17716,19616,19300,22720,21220,26980,19983,26080,19933,20616,20320,19640,20683,21966,19775,20650,20180,21520,22620,21780,20720,44140,22440,23300,21360,20820,23780,24120,23940,22640,23100,24680,23660,25320,23840,25480,27380,24680,24625,23800,25000,25375,25800,26000,25875,26460,22975,26825,26850,26900,25925,26225,26900,26075,27850,24200,28525,29275,14750,28375,28675,27300,30025,30275,31125,30300,33400,30450,29375,31175,21200,29650,30275,34925,30425,33375,33050,33375,33800,33850,31850,31825,31950,30466,33375,31266,36175,29866,37500,29733,31533,36775,30866,33033,31200,25100,32833,31533,34033,32200,32100,34600,37333,35066,33933,33166,35666,37666,35400,35733,36266,34700,36666,34533,37333,35566,35800,38000,38166,38733,40233,38033,39133,38466,38966,40033,38666,38433,40666,37633,38466,41066,38200,40566,41266,39033,41900,39300,42100,41866,45500,39766,43000,43200,40600,43300,52433,43766,45833,41766,44833,44800,46800,45233,44833,42633,47300,45933,45466,47800,47633,46766,47866,47700,65400,47533,51133,48333,46333,48700,50733,47600,49333,49600,42650,40350,47200,49300,48366,50166,48233,50633,50833,51333,49133,38100,49366,39950,40750,40700,39450,49100,53500,40400,38050,40200,53766,43400,40800,43000,42900,51566,41000,43200,41900,42250,43100,50150,42450,41850,43500,40400,43250,44250,45000,53000,42500,44200,42250,44550,41700,44800,45000,42250,45450,42600,46500,44100,45750,47850,44000,46400,47250,46650,44300,46250,112800,57450,56650,54000,47150,49400,48850,61250,49450,51350,49700,137000,50000,46800,50250,50750,50950,51650,48000,50150,47750,50750,51850,47950,50950,51750,51500,51250,47200,52600,52400,52650,49300,52550,53250,53250,56150,53150,55250,54150,54200,55000,51800,57700,57700,55850,53350,55850,55600,52900,57050,53650,57650,58200,53350,54800,58900,58500,56750,58050,58200,57500,56050,58750,56800,59350,58100,60450,57100,58500,59300,59550,60650,60950,57150,60750,165500,60300,60550,61400,63450,61450,62150,81400,60750,78550,65200,63900,62000,61850,62400,59550,59100,60400,62150,59600,65050,60050,62350,65700,64850,61250,63350,60700,63700,61000,60650,61650,66300,61300,67200,68950,66650,63750,66000,66250,66800,67200,68100,86350,64650,72150,225900,76950,70250,67850,71900,69200,66050,70150,68200,63550,89950,69700,91150,88900,116100,94400,72500,69450,70400,60200,88150,91800,77400,107800,100100,97100,90400,87550,94850,100050,255850,92800,100750,76650,111950,94150,104450,99450,70150,80950,96450,76100,77300,75050,76350,79000,74850,77100,78000,79100,74650,102300,74900,78900,79550,80600,103750,106050]
    line "sort::intro_sort" [44,122,245,403,581,920,1039,1228,1376,1722,1728,1904,2313,2479,2575,2896,5905,3407,5050,3576,4092,4336,4518,4593,4236,5204,5880,6244,5647,7607,6493,6637,7162,7237,7293,7266,12828,7992,7492,8453,8723,8969,9333,9133,9645,10172,9881,10866,10760,10900,10510,12028,11760,11644,12088,11722,12575,12737,13300,13550,13000,13600,13087,13500,38775,14371,14457,15157,15171,14912,15857,15242,15471,17385,17171,17257,18540,17600,26460,16550,17283,17842,18283,17866,19250,18333,18783,18566,19950,19260,20650,21366,20250,20333,25000,21540,27440,20775,25300,24550,24300,48300,30360,27525,22800,23820,24020,23680,24120,23280,25340,23980,25100,25720,24940,24600,24980,13250,25100,25300,27020,26800,28280,27725,26800,25700,25875,27625,26250,28200,26650,28250,28550,27350,29025,28250,30200,30175,30250,30775,31150,29900,29650,31600,31975,32175,30625,30950,32675,32800,33050,31225,34075,34050,32750,33575,30500,26033,31433,31833,34025,32200,35150,31966,39000,32833,33766,31166,32433,34366,32066,34800,34866,35066,35433,40066,35066,33866,33600,36133,34966,37066,35566,35600,35466,34766,37133,36266,37166,39066,37066,38900,39200,36833,40833,37966,37166,40166,38766,40433,39833,39333,42366,42933,42466,42266,42900,40900,44100,44166,43900,37333,42100,44533,42200,44800,43666,42166,45366,45733,45533,47000,45400,45000,44466,42233,48500,47833,44966,47866,47866,46133,49000,48533,48633,49100,50800,47400,50000,51433,47833,51900,51466,52566,53300,49200,52566,52300,49466,50100,39200,37550,41350,40350,40550,41700,43600,40550,42950,40950,41050,42700,42600,42500,45400,44100,40700,42200,43100,44450,41050,57300,42200,43950,42150,46850,41950,45000,44150,46850,42900,45450,54350,52850,46400,47050,46050,45050,44200,47250,44050,46300,46750,51200,46600,48000,54600,45300,48200,49100,50450,56950,49950,59500,49750,48900,50300,49550,51200,49950,51600,53000,53150,51450,55950,51850,48800,56750,53600,52400,52900,49700,56350,53050,57050,66050,51300,54100,53200,55100,51450,54900,54250,66450,70700,56150,55150,53450,56650,67800,57700,59500,61600,54450,58250,54500,58050,60650,58800,60650,58350,58650,56100,58750,61250,57150,59750,60200,61800,60750,55400,61600,60850,64450,57850,62600,62300,62900,63800,60550,63700,62800,63700,64150,60200,64100,61600,66100,61800,68200,64900,68550,65500,62050,61100,68550,62300,69650,65300,65600,66650,66750,67200,66400,65250,69950,66000,68300,66550,66500,66450,67600,68800,68750,70700,69950,69700,70500,137300,70850,82650,75100,87100,70750,71550,72950,72200,74100,64250,95250,72150,72150,72050,72700,73050,72500,72050,70450,75450,69400,73250,71600,75350,71250,75750,75800,74800,70950,70050,71100,76500,71400,75600,76900,80200,73500,77450,79800,82800,76700,96500,96350,74950,79950,79700,89900,81650,78550,81800,85900,75600,92600,79750,79450,100150,89050,101400,102900,107400,105900,243600,80400,108150,305000,107800,86050,89700,111700,88800,113500,218200,102450,137350,200700,112900,632600,113800,87550,113400,104950,225500,84650,82100,93850,247100,201000,88550,87950,88000,87050,87000,89050,87900,87200,85850,118750,99850,89250,91300,87750,120350,119450]
    line "sort::sort" [61,229,234,365,513,700,902,1071,1177,1109,1380,1510,1514,1917,2109,2154,2205,2451,2633,2586,2735,3060,3244,3336,3548,3692,3310,3773,3952,5891,4423,4430,10310,11030,11580,10754,10750,11888,11800,11722,11844,12133,12355,11777,12577,12988,12255,12625,13233,13187,12462,12537,13650,13687,13900,14812,14325,14475,14237,17100,13500,15685,12660,13757,14985,15100,14742,14533,15042,16528,15628,14657,15942,15628,16100,16285,16300,15683,16557,19800,13785,15914,17271,21580,17600,16300,15966,16714,17216,17533,17200,17566,19216,19928,21050,18266,31700,18416,18383,22675,19000,22766,19025,37725,19133,19183,19466,19416,19733,18666,19833,20850,20800,20616,19516,20666,19683,20650,20433,20983,20016,22783,19733,39366,21320,22083,20566,20880,22666,21300,20600,21760,21740,20460,21800,21020,21480,22200,22380,22560,22820,21480,21960,22680,23100,24060,22340,22100,23460,24780,23780,22660,24200,24080,22940,24580,24580,23700,24680,24980,23440,26400,23940,25400,24000,25800,24225,25900,25940,24500,24920,24625,24950,24925,25500,25875,25360,24125,23300,25650,26140,25975,26500,24850,24925,29325,26600,25325,27250,26700,27150,27425,27200,26325,27575,29700,25775,28125,26225,28300,29650,26725,26100,28800,32225,29225,29050,27450,29350,27625,28800,28200,27975,29775,28225,29650,31325,28850,30600,30450,31100,36650,30975,29625,34000,30000,29950,31800,30500,31850,32000,30225,31950,30250,32975,32625,32750,32850,33200,33275,28000,33825,33400,33425,28400,32250,34450,34375,32425,34350,34800,34525,34900,35300,35050,31833,31266,31266,31866,32133,32100,32233,34200,33133,30833,32366,30800,32500,32900,32833,31833,32800,31600,33833,31600,34266,32200,34100,33833,33866,36700,34666,32766,34766,35166,33800,35200,33266,32666,35966,33200,35533,36300,33233,36066,36300,36166,39400,37000,35900,36566,37033,36700,47100,37533,37300,41033,43433,39733,37766,38066,37900,36466,37500,38233,38266,36966,39300,39000,37333,38300,37166,39366,36000,40900,39066,37833,40200,39833,42033,41700,40400,40800,39100,39700,40800,41133,38833,43500,40433,43900,40766,42333,40133,42200,40000,42033,43233,40833,42966,40566,43833,44166,43400,43533,44066,44866,44000,44600,43833,46933,44733,45233,44733,42600,45033,44666,44900,45000,45133,51400,45333,45866,45900,47966,46133,45133,46733,33700,47233,46733,43433,46500,45166,48800,47700,45500,45266,48700,36250,48266,48533,48166,52966,46333,48966,48933,49800,49166,35600,49800,38000,49733,40300,42200,37650,50533,51166,54950,48233,55266,52233,51200,39100,51566,51633,51466,39250,36800,39050,39500,2600,43600,51133,57833,52100,39750,51166,40750,53133,44300,53700,53800,38400,39650,39550,41300,51966,39300,38850,41850,39950,41950,41850,41500,40550,42550,42350,45100,42900,62000,61400,40500,44150,42400,54750,42700,50600,43200,46150,42000,53900,44750,54600,65700,44400,44850,58500,68350,61350,144400,60250,44550,70700,69600,72550,63900,74350,50400,68000,460700,62200,62500,69100,136400,504600,62850,72900,65600,68150,66800,45850,44650,48250,50950,56950,137600,48200,51350,48650,61050,49050,48350,49150,48800,71200,48150,49800,49750,49750,54050,49900]

```